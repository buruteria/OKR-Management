<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OKR Management Tool - Google Sheets ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            background: white;
            border-radius: 12px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2d3748;
            text-align: center;
            margin-bottom: 30px;
        }
        .step {
            background: #f7fafc;
            border-left: 4px solid #4299e1;
            padding: 20px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
        }
        .step h3 {
            color: #2d3748;
            margin-top: 0;
        }
        .button {
            background: #4299e1;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            text-decoration: none;
            display: inline-block;
            margin: 10px 5px;
            font-size: 14px;
            transition: background 0.3s;
        }
        .button:hover {
            background: #3182ce;
        }
        .button.success {
            background: #48bb78;
        }
        .button.success:hover {
            background: #38a169;
        }
        .code-block {
            background: #1a202c;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            margin: 10px 0;
            overflow-x: auto;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 14px;
        }
        .alert {
            background: #fed7d7;
            border: 1px solid #feb2b2;
            color: #c53030;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
        }
        .success-alert {
            background: #c6f6d5;
            border: 1px solid #9ae6b4;
            color: #2f855a;
        }
        .copy-btn {
            float: right;
            background: #4a5568;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }
        .copy-btn:hover {
            background: #2d3748;
        }
        #status {
            margin-top: 20px;
            padding: 15px;
            border-radius: 6px;
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¯ OKR Management Tool<br>Google Sheets ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—</h1>
        
        <div class="step">
            <h3>ğŸ“Š Step 1: ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚’ä½œæˆ</h3>
            <p>ä¸‹ã®ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã€OKRç®¡ç†ç”¨ã®Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚</p>
            <button class="button" onclick="createTemplate()">ğŸ“Š ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½œæˆ</button>
            <div id="sheet-info" style="display: none;">
                <div class="success-alert">
                    <strong>âœ… ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆä½œæˆå®Œäº†ï¼</strong><br>
                    ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆID: <span id="spreadsheet-id"></span><br>
                    <a id="spreadsheet-link" href="#" target="_blank">ğŸ“Š ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚’é–‹ã</a>
                </div>
            </div>
        </div>

        <div class="step">
            <h3>âš¡ Step 2: Apps Script ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ</h3>
            <p>ä½œæˆã•ã‚ŒãŸã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã§ä»¥ä¸‹ã®æ‰‹é †ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ï¼š</p>
            <ol>
                <li>ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã§ã€Œæ‹¡å¼µæ©Ÿèƒ½ã€â†’ã€ŒApps Scriptã€ã‚’ã‚¯ãƒªãƒƒã‚¯</li>
                <li>æ—¢å­˜ã®ã‚³ãƒ¼ãƒ‰ã‚’å‰Šé™¤ã—ã€ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼ï¼†ãƒšãƒ¼ã‚¹ãƒˆ</li>
                <li>ã€Œä¿å­˜ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯</li>
            </ol>
            
            <div style="position: relative;">
                <button class="copy-btn" onclick="copyCode('apps-script-code')">ğŸ“‹ ã‚³ãƒ”ãƒ¼</button>
                <div class="code-block" id="apps-script-code">/**
 * OKR Management Tool - Google Apps Script Backend
 * Google Sheets APIçµ±åˆç”¨ã®ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
 */

// è¨­å®š
const CONFIG = {
  SPREADSHEET_ID: SpreadsheetApp.getActiveSpreadsheet().getId(),
  SHEETS: {
    OKR_DATA: 'OKR_Data',
    PROGRESS: 'Progress_History',
    WEEKLY_REVIEW: 'Weekly_Reviews'
  }
};

/**
 * åˆæœŸã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—é–¢æ•°
 */
function setupOKRManagement() {
  const ss = SpreadsheetApp.getActiveSpreadsheet();
  
  // å¿…è¦ãªã‚·ãƒ¼ãƒˆã‚’ä½œæˆ
  setupOKRDataSheet(ss);
  setupProgressSheet(ss);
  setupWeeklyReviewSheet(ss);
  
  Logger.log('OKR Management setup completed!');
  
  return {
    spreadsheetId: ss.getId(),
    spreadsheetUrl: ss.getUrl(),
    message: 'ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãŒå®Œäº†ã—ã¾ã—ãŸ'
  };
}

/**
 * Web App ã®ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
 */
function doPost(e) {
  try {
    const requestData = JSON.parse(e.postData.contents);
    const action = requestData.action;
    
    switch (action) {
      case 'sync_okr_data':
        return syncOKRData(requestData.data);
      case 'get_okr_data':
        return getOKRData();
      case 'save_progress':
        return saveProgress(requestData.data);
      case 'get_progress_history':
        return getProgressHistory();
      default:
        throw new Error('Invalid action: ' + action);
    }
  } catch (error) {
    Logger.log('Error in doPost: ' + error.toString());
    return ContentService
      .createTextOutput(JSON.stringify({
        success: false,
        error: error.toString()
      }))
      .setMimeType(ContentService.MimeType.JSON);
  }
}

/**
 * OKRãƒ‡ãƒ¼ã‚¿ã®åŒæœŸ
 */
function syncOKRData(data) {
  try {
    const ss = SpreadsheetApp.getActiveSpreadsheet();
    let sheet = ss.getSheetByName(CONFIG.SHEETS.OKR_DATA);
    
    if (!sheet) {
      sheet = setupOKRDataSheet(ss);
    }
    
    const timestamp = new Date();
    const row = [
      timestamp,
      data.northStar || '',
      JSON.stringify(data.objectives || []),
      JSON.stringify(data.keyResults || []),
      JSON.stringify(data.progressHistory || []),
      JSON.stringify(data.adjustmentHistory || []),
      JSON.stringify(data.weeklyReviews || [])
    ];
    
    const lastRow = sheet.getLastRow();
    if (lastRow > 1) {
      sheet.getRange(lastRow, 1, 1, row.length).setValues([row]);
    } else {
      sheet.appendRow(row);
    }
    
    return ContentService
      .createTextOutput(JSON.stringify({
        success: true,
        message: 'OKRãƒ‡ãƒ¼ã‚¿ãŒæ­£å¸¸ã«åŒæœŸã•ã‚Œã¾ã—ãŸ',
        timestamp: timestamp.toISOString()
      }))
      .setMimeType(ContentService.MimeType.JSON);
      
  } catch (error) {
    Logger.log('Error in syncOKRData: ' + error.toString());
    throw error;
  }
}

/**
 * OKRãƒ‡ãƒ¼ã‚¿ã®å–å¾—
 */
function getOKRData() {
  try {
    const ss = SpreadsheetApp.getActiveSpreadsheet();
    const sheet = ss.getSheetByName(CONFIG.SHEETS.OKR_DATA);
    
    if (!sheet || sheet.getLastRow() <= 1) {
      return ContentService
        .createTextOutput(JSON.stringify({
          success: true,
          data: {},
          message: 'ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“'
        }))
        .setMimeType(ContentService.MimeType.JSON);
    }
    
    const lastRow = sheet.getLastRow();
    const data = sheet.getRange(lastRow, 1, 1, 7).getValues()[0];
    
    const okrData = {
      timestamp: data[0],
      northStar: data[1],
      objectives: JSON.parse(data[2] || '[]'),
      keyResults: JSON.parse(data[3] || '[]'),
      progressHistory: JSON.parse(data[4] || '[]'),
      adjustmentHistory: JSON.parse(data[5] || '[]'),
      weeklyReviews: JSON.parse(data[6] || '[]')
    };
    
    return ContentService
      .createTextOutput(JSON.stringify({
        success: true,
        data: okrData
      }))
      .setMimeType(ContentService.MimeType.JSON);
      
  } catch (error) {
    Logger.log('Error in getOKRData: ' + error.toString());
    throw error;
  }
}

/**
 * é€²æ—ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜
 */
function saveProgress(progressData) {
  try {
    const ss = SpreadsheetApp.getActiveSpreadsheet();
    let sheet = ss.getSheetByName(CONFIG.SHEETS.PROGRESS);
    
    if (!sheet) {
      sheet = setupProgressSheet(ss);
    }
    
    const row = [
      new Date(progressData.date),
      progressData.activity || '',
      progressData.result || '',
      JSON.stringify(progressData.relatedKRs || []),
      progressData.mood || 'ğŸ˜'
    ];
    
    sheet.appendRow(row);
    
    return ContentService
      .createTextOutput(JSON.stringify({
        success: true,
        message: 'é€²æ—ãƒ‡ãƒ¼ã‚¿ãŒä¿å­˜ã•ã‚Œã¾ã—ãŸ'
      }))
      .setMimeType(ContentService.MimeType.JSON);
      
  } catch (error) {
    Logger.log('Error in saveProgress: ' + error.toString());
    throw error;
  }
}

/**
 * é€²æ—å±¥æ­´ã®å–å¾—
 */
function getProgressHistory(limit = 30) {
  try {
    const ss = SpreadsheetApp.getActiveSpreadsheet();
    const sheet = ss.getSheetByName(CONFIG.SHEETS.PROGRESS);
    
    if (!sheet || sheet.getLastRow() <= 1) {
      return ContentService
        .createTextOutput(JSON.stringify({
          success: true,
          data: [],
          message: 'é€²æ—ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“'
        }))
        .setMimeType(ContentService.MimeType.JSON);
    }
    
    const lastRow = sheet.getLastRow();
    const startRow = Math.max(2, lastRow - limit + 1);
    const numRows = lastRow - startRow + 1;
    
    const data = sheet.getRange(startRow, 1, numRows, 5).getValues();
    
    const progressHistory = data.map(row => ({
      date: row[0].toISOString(),
      activity: row[1],
      result: row[2],
      relatedKRs: JSON.parse(row[3] || '[]'),
      mood: row[4]
    })).reverse();
    
    return ContentService
      .createTextOutput(JSON.stringify({
        success: true,
        data: progressHistory
      }))
      .setMimeType(ContentService.MimeType.JSON);
      
  } catch (error) {
    Logger.log('Error in getProgressHistory: ' + error.toString());
    throw error;
  }
}

/**
 * OKRãƒ‡ãƒ¼ã‚¿ã‚·ãƒ¼ãƒˆã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
 */
function setupOKRDataSheet(ss) {
  let sheet = ss.getSheetByName(CONFIG.SHEETS.OKR_DATA);
  
  if (sheet) {
    ss.deleteSheet(sheet);
  }
  
  sheet = ss.insertSheet(CONFIG.SHEETS.OKR_DATA);
  
  const headers = [
    'Timestamp',
    'North Star',
    'Objectives',
    'Key Results',
    'Progress History',
    'Adjustment History',
    'Weekly Reviews'
  ];
  
  sheet.getRange(1, 1, 1, headers.length).setValues([headers]);
  sheet.getRange(1, 1, 1, headers.length).setFontWeight('bold');
  sheet.getRange(1, 1, 1, headers.length).setBackground('#4299e1');
  sheet.getRange(1, 1, 1, headers.length).setFontColor('white');
  sheet.setFrozenRows(1);
  
  // ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’è¿½åŠ 
  const sampleData = [
    new Date(),
    'ç·¨é›†è€…Ã—æµ·å¤–å•†ç¤¾ãƒ¢ãƒ‡ãƒ«ã‚’ç¢ºç«‹ã—ã€æ—¥æœ¬ã®å°‚é–€çŸ¥ãƒ»æ–‡åŒ–ã‚’æµ·å¤–å±•é–‹ã™ã‚‹äº‹æ¥­ã§æœˆ50ä¸‡å††ã‚’é”æˆã—ã¦ã„ã‚‹',
    JSON.stringify([{
      id: 1,
      text: 'ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªå…¬é–‹ã‚’èµ·ç‚¹ã«ã€æµ·å¤–å±•é–‹å¯èƒ½ãªäº‹æ¥­ã®ç¨®ã‚’è¦‹ã¤ã‘ã€åç›ŠåŒ–ã®åˆæœŸæ¤œè¨¼ã‚’å®Œäº†ã™ã‚‹',
      status: 'active'
    }]),
    JSON.stringify([
      {
        id: 1,
        objectiveId: 1,
        text: '6æœˆ30æ—¥ã¾ã§ã«ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã‚µã‚¤ãƒˆã‚’å…¬é–‹ã—ã€7æœˆä¸­ã«æ–°è¦å•ã„åˆã‚ã›ã‚’5ä»¶ç²å¾—ã™ã‚‹',
        current: 3,
        target: 5,
        unit: 'ä»¶'
      },
      {
        id: 2,
        objectiveId: 1,
        text: 'noteè¨˜äº‹3æœ¬ã‚’å…¬é–‹ã—ã€åˆè¨ˆ200ã„ã„ã­ä»¥ä¸Šç²å¾—ã™ã‚‹',
        current: 120,
        target: 200,
        unit: 'ã„ã„ã­'
      },
      {
        id: 3,
        objectiveId: 1,
        text: 'æµ·å¤–å±•é–‹ã«é–¢å¿ƒã®ã‚ã‚‹èµ·æ¥­å®¶ãƒ»å°‚é–€å®¶ã¨3åä»¥ä¸Šå¯¾è©±ã—ã€äº‹æ¥­ä»®èª¬ã‚’3ã¤ç«‹æ¡ˆã™ã‚‹',
        current: 2,
        target: 3,
        unit: 'å'
      }
    ]),
    '[]',
    '[]',
    '[]'
  ];
  
  sheet.appendRow(sampleData);
  
  return sheet;
}

/**
 * é€²æ—ã‚·ãƒ¼ãƒˆã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
 */
function setupProgressSheet(ss) {
  let sheet = ss.getSheetByName(CONFIG.SHEETS.PROGRESS);
  
  if (sheet) {
    ss.deleteSheet(sheet);
  }
  
  sheet = ss.insertSheet(CONFIG.SHEETS.PROGRESS);
  
  const headers = [
    'Date',
    'Activity',
    'Result',
    'Related KRs',
    'Mood'
  ];
  
  sheet.getRange(1, 1, 1, headers.length).setValues([headers]);
  sheet.getRange(1, 1, 1, headers.length).setFontWeight('bold');
  sheet.getRange(1, 1, 1, headers.length).setBackground('#48bb78');
  sheet.getRange(1, 1, 1, headers.length).setFontColor('white');
  sheet.setFrozenRows(1);
  
  // ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’è¿½åŠ 
  const today = new Date();
  const sampleData = [
    [
      new Date(today.getTime() - 86400000), // æ˜¨æ—¥
      'ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã‚µã‚¤ãƒˆã®ãƒ‡ã‚¶ã‚¤ãƒ³æ¤œè¨',
      'å‚è€ƒã‚µã‚¤ãƒˆã‚’5ã¤ãƒ”ãƒƒã‚¯ã‚¢ãƒƒãƒ—ã—ã€ãƒ‡ã‚¶ã‚¤ãƒ³ã®æ–¹å‘æ€§ã‚’æ±ºå®š',
      JSON.stringify([1]),
      'ğŸ˜Š'
    ],
    [
      today,
      'noteè¨˜äº‹ã®åŸ·ç­†',
      'ã€Œæµ·å¤–å±•é–‹ã®å¯èƒ½æ€§ã€ã«ã¤ã„ã¦2000æ–‡å­—ã®è¨˜äº‹ã‚’å®Œæˆ',
      JSON.stringify([2]),
      'ğŸ˜„'
    ]
  ];
  
  sampleData.forEach(row => sheet.appendRow(row));
  
  return sheet;
}

/**
 * é€±æ¬¡ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚·ãƒ¼ãƒˆã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
 */
function setupWeeklyReviewSheet(ss) {
  let sheet = ss.getSheetByName(CONFIG.SHEETS.WEEKLY_REVIEW);
  
  if (sheet) {
    ss.deleteSheet(sheet);
  }
  
  sheet = ss.insertSheet(CONFIG.SHEETS.WEEKLY_REVIEW);
  
  const headers = [
    'Week Ending',
    'Achievements',
    'Challenges',
    'Next Week Focus',
    'Mood Rating',
    'Notes'
  ];
  
  sheet.getRange(1, 1, 1, headers.length).setValues([headers]);
  sheet.getRange(1, 1, 1, headers.length).setFontWeight('bold');
  sheet.getRange(1, 1, 1, headers.length).setBackground('#ed8936');
  sheet.getRange(1, 1, 1, headers.length).setFontColor('white');
  sheet.setFrozenRows(1);
  
  return sheet;
}</div>
            </div>
        </div>

        <div class="step">
            <h3>ğŸš€ Step 3: Web App ã¨ã—ã¦å…¬é–‹</h3>
            <ol>
                <li>Apps Scriptã‚¨ãƒ‡ã‚£ã‚¿ã§ã€Œãƒ‡ãƒ—ãƒ­ã‚¤ã€â†’ã€Œæ–°ã—ã„ãƒ‡ãƒ—ãƒ­ã‚¤ã€ã‚’ã‚¯ãƒªãƒƒã‚¯</li>
                <li>ç¨®é¡ã‚’ã€Œã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªã€ã«é¸æŠ</li>
                <li>å®Ÿè¡Œè€…: è‡ªåˆ†</li>
                <li>ã‚¢ã‚¯ã‚»ã‚¹: å…¨å“¡</li>
                <li>ã€Œãƒ‡ãƒ—ãƒ­ã‚¤ã€ã‚’ã‚¯ãƒªãƒƒã‚¯</li>
                <li>è¡¨ç¤ºã•ã‚ŒãŸWeb App URLã‚’ã‚³ãƒ”ãƒ¼</li>
            </ol>
            
            <div class="alert">
                <strong>âš ï¸ é‡è¦:</strong> ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œã«è¡¨ç¤ºã•ã‚Œã‚‹Web App URLã‚’å¿…ãšã‚³ãƒ”ãƒ¼ã—ã¦ãã ã•ã„ã€‚
            </div>
        </div>

        <div class="step">
            <h3>âš™ï¸ Step 4: OKRãƒ„ãƒ¼ãƒ«ã§è¨­å®š</h3>
            <ol>
                <li>OKRç®¡ç†ãƒ„ãƒ¼ãƒ«ã‚’é–‹ã</li>
                <li>ã€Œâš™ï¸ è¨­å®šã€â†’ã€ŒAPIè¨­å®šã€ã‚¿ãƒ–ã‚’é¸æŠ</li>
                <li>ã€ŒSpreadsheet IDã€ã«ä½œæˆã—ãŸã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®IDã‚’å…¥åŠ›</li>
                <li>ã€ŒWeb App URLã€ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã—ãŸURLã‚’å…¥åŠ›</li>
                <li>ã€Œè¨­å®šã‚’ä¿å­˜ã€ã‚’ã‚¯ãƒªãƒƒã‚¯</li>
            </ol>
            
            <button class="button success" onclick="openOKRTool()">ğŸ¯ OKRãƒ„ãƒ¼ãƒ«ã‚’é–‹ã</button>
        </div>

        <div id="status"></div>
    </div>

    <script>
        function createTemplate() {
            const templateUrl = 'https://docs.google.com/spreadsheets/d/1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms/copy';
            
            // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ã‚³ãƒ”ãƒ¼ã‚’ä½œæˆ
            window.open(templateUrl + '?title=OKR Management Tool - Data', '_blank');
            
            // UIæ›´æ–°
            document.getElementById('sheet-info').style.display = 'block';
            showStatus('ğŸ“Š ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’é–‹ã„ã¦ã„ã¾ã™...', 'info');
            
            setTimeout(() => {
                showStatus('âœ… æ–°ã—ã„ã‚¿ãƒ–ã§ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆãŒé–‹ã‹ã‚Œã¾ã—ãŸã€‚Step 2ã«é€²ã‚“ã§ãã ã•ã„ã€‚', 'success');
            }, 2000);
        }

        function copyCode(elementId) {
            const element = document.getElementById(elementId);
            const text = element.textContent;
            
            navigator.clipboard.writeText(text).then(() => {
                showStatus('ğŸ“‹ ã‚³ãƒ¼ãƒ‰ãŒã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã•ã‚Œã¾ã—ãŸï¼', 'success');
            }).catch(() => {
                // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
                const textArea = document.createElement('textarea');
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                showStatus('ğŸ“‹ ã‚³ãƒ¼ãƒ‰ãŒã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã•ã‚Œã¾ã—ãŸï¼', 'success');
            });
        }

        function openOKRTool() {
            window.open('../src/index.html', '_blank');
        }

        function showStatus(message, type) {
            const status = document.getElementById('status');
            status.style.display = 'block';
            status.textContent = message;
            
            status.className = '';
            if (type === 'success') {
                status.className = 'success-alert';
            } else if (type === 'error') {
                status.className = 'alert';
            } else {
                status.style.background = '#bee3f8';
                status.style.border = '1px solid #90cdf4';
                status.style.color = '#2c5282';
            }
        }
    </script>
</body>
</html>